<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mayday Plumbing - Professional Plumbing Services in Virginia</title>
    <meta name="description" content="Professional plumbing services in Salem, Roanoke, and surrounding Virginia areas. Licensed and insured plumbers.">
    <link rel="icon" type="image/x-icon" href="/static/img/favicon.ico">
    <link rel="stylesheet" href="/static/css/index.css">
    <link href="https://fonts.googleapis.com/css2?family={{ font_settings.heading_font|replace(' ', '+') }}:wght@300;400;500;600;700&family={{ font_settings.body_font|replace(' ', '+') }}:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    {% if recaptcha_site_key %}
    <!-- Google reCAPTCHA v3 -->
    <script src="https://www.google.com/recaptcha/api.js?render={{ recaptcha_site_key }}" async defer></script>
    {% endif %}

    <!-- Dynamic font settings from database -->
    <style>
        :root {
            --font-heading: '{{ font_settings.heading_font }}', sans-serif;
            --font-body: '{{ font_settings.body_font }}', sans-serif;
        }

        {% if font_settings.custom_css %}
        /* Custom CSS from admin panel */
        {{ font_settings.custom_css|safe }}
        {% endif %}
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <div class="image-container" data-image-key="logo">
                    <img src="/static/img/mayday-translucent.png" alt="Mayday Plumbing Logo">
                    {% if admin == true %}
                    <button class="image-upload-btn" title="Replace Logo">
                        <i class="fas fa-camera"></i>
                    </button>
                    <input type="file" class="image-upload-input" accept="image/*" style="display: none;">
                    {% endif %}
                </div>
                <span>Mayday Plumbing</span>
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link">Home</a>
                <a href="#services" class="nav-link">Services</a>
                <a href="/about" class="nav-link">About</a>
                <a href="#contact" class="nav-link">Contact</a>
                <a href="/blog" class="nav-link">Blog</a>
                <a href="https://client.housecallpro.com/customer_portal/request-link?token=e57304ab4e974b93a5b90c2084ba3d1a" target="_blank" class="nav-link">Invoices</a>
                {% if admin == true %}
                <a href="#admin" class="nav-link">Admin</a>
                <a href="/logout" class="nav-link">Logout</a>
                {% endif %}
            </div>
            <div class="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="hero-overlay"></div>
        {% if admin == true %}
        <div class="hero-image-upload">
            <button class="image-upload-btn hero-upload-btn" data-image-key="hero" title="Replace Hero Background">
                <i class="fas fa-camera"></i>
            </button>
            <input type="file" class="image-upload-input" accept="image/*" style="display: none;">
        </div>
        {% endif %}
        <div class="hero-content">
            <h1 class="hero-title">{{ descriptions.get('hero-title') or 'Professional Plumbing Services You Can Trust' }}</h1>
            <p class="hero-subtitle">{{ descriptions.get('hero-subtitle') or 'Serving Salem, Roanoke, and surrounding Virginia areas with reliable, professional plumbing solutions' }}</p>
            <div class="hero-cta">
                <a href="tel:5405214181" class="btn btn-primary">
                    <i class="fas fa-phone"></i> Call Now: (540) 521-4181
                </a>
                <a href="#services" class="btn btn-secondary">
                    <i class="fas fa-calendar"></i> Schedule Service
                </a>
            </div>
        </div>
        <div class="hero-features">
            <div class="feature-item">
                <form action="https://dporweb.dpor.virginia.gov/LicenseLookup/Search" method="POST" target="_blank" style="margin: 0; padding: 0;">
                    <input type="hidden" name="phone-number" value="">
                    <input type="hidden" name="search-text" value="2705191750">
                    <button type="submit" class="feature-link" style="background: none; border: none; cursor: pointer; display: flex; align-items: center; gap: 0.75rem; color: white; font-size: 0.875rem; font-weight: 500; text-decoration: none; transition: opacity 0.3s ease;">
                        <i class="fas fa-shield-alt" style="font-size: 1.25rem; color: var(--secondary-color);"></i>
                        <span>Licensed & Insured</span>
                    </button>
                </form>
            </div>
            <div class="feature-item">
                <a href="https://www.bbb.org/us/va/troutville/profile/plumber/mayday-plumbing-llc-0613-90039763" target="_blank" class="feature-link">
                    <i class="fas fa-award"></i>
                    <span>Better Business Bureau</span>
                </a>
            </div>
            <div class="feature-item">
                <a href="https://share.google/7Fr3A6mkyLSOwMtJH" target="_blank" class="feature-link">
                    <div class="star-rating" id="google-rating">
                        {% if google_rating.rating %}
                        {% set rating = google_rating.rating %}
                        {% set full_stars = rating|int %}
                        {% set has_half_star = (rating - full_stars) >= 0.5 %}
                        {% for i in range(full_stars) %}
                        <i class="fas fa-star"></i>
                        {% endfor %}
                        {% if has_half_star %}
                        <i class="fas fa-star-half-alt"></i>
                        {% endif %}
                        {% for i in range(5 - full_stars - (1 if has_half_star else 0)) %}
                        <i class="far fa-star"></i>
                        {% endfor %}
                        <span>{{ "%.1f"|format(google_rating.rating) }} Google Reviews{% if google_rating.review_count > 0 %} ({{ google_rating.review_count }}){% endif %}</span>
                        {% else %}
                        <i class="fas fa-star" style="color: #fbbf24;"></i>
                        <i class="fas fa-star" style="color: #fbbf24;"></i>
                        <i class="fas fa-star" style="color: #fbbf24;"></i>
                        <i class="fas fa-star" style="color: #fbbf24;"></i>
                        <i class="fas fa-star" style="color: #fbbf24;"></i>
                        <span>Google Reviews <i class="fas fa-spinner fa-spin" style="margin-left: 5px;"></i></span>
                        {% endif %}
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- Google Reviews Widget -->
    <section id="google-reviews" class="google-reviews-section">
        <div class="container">
            <div class="reviews-widget">
                <div class="reviews-header">
                    <div class="reviews-title">
                        <i class="fab fa-google"></i>
                        <h3>Google Reviews</h3>
                    </div>
                    <div class="reviews-rating-summary">
                        <div class="rating-stars" id="widget-rating-stars">
                            <!-- Stars will be populated dynamically -->
                        </div>
                        <span class="rating-text" id="widget-rating-text">Loading...</span>
                    </div>
                </div>
                <div class="reviews-carousel">
                    <div class="review-card" id="current-review">
                        <div class="review-loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Loading reviews...</span>
                        </div>
                    </div>
                    <div class="reviews-navigation">
                        <button class="review-nav-btn" id="prev-review" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="review-indicators" id="review-indicators">
                            <!-- Indicators will be populated dynamically -->
                        </div>
                        <button class="review-nav-btn" id="next-review" disabled>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                <div class="reviews-footer">
                    <a href="https://share.google/7Fr3A6mkyLSOwMtJH" target="_blank" class="reviews-link">
                        <i class="fas fa-external-link-alt"></i>
                        View all reviews on Google
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Event Notification -->
    {% if event %}
    <div id="notification" class="notification notification-{{ event_type }}">
        <div class="container">
            <span class="notification-message">{{ event }}</span>
            <button class="notification-close">&times;</button>
        </div>
    </div>
    {% endif %}

    <!-- Announcement Banner -->
    {% if announcement and announcement.active %}
    <div class="announcement-banner announcement-{{ announcement.type }}">
        <div class="container">
            <div class="announcement-content">
                <i class="fas fa-bullhorn"></i>
                <span class="announcement-text">{{ announcement.text }}</span>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- All Services Section -->
    <section id="all-services" class="all-services-section">
        <div class="container">
            <div class="section-header">
                <h2>Our Services</h2>
                <p>{{ descriptions.get('all-services') or 'Complete plumbing solutions for residential and commercial properties' }}</p>
            </div>
            
            <div class="services-list-grid" id="servicesGrid">
                {% for service in db_services %}
                <div class="service-list-item" data-service-id="{{ service.id }}" draggable="{{ 'true' if admin == true else 'false' }}">
                    {% if admin == true %}
                    <div class="drag-handle">
                        <i class="fas fa-grip-vertical"></i>
                    </div>
                    {% endif %}
                    <div class="service-icon">
                        <i class="{{ service.icon }}"></i>
                    </div>
                    <h3>{{ service.title }}</h3>
                    <p>{{ service.description }}</p>
                    {% if admin == true %}
                    <div class="admin-actions">
                        <button class="btn-edit-service" title="Edit Service">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-service" title="Delete Service">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                {% if admin == true %}
                <div class="service-list-item add-service-item">
                    <div class="service-icon">
                        <i class="fas fa-plus"></i>
                    </div>
                    <h3>Add New Service</h3>
                    <p>Click to add a new service</p>
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Online Services Section -->
    <section id="services" class="services-section">
        <div class="container">
            <div class="section-header">
                <h2>Schedule a Visit</h2>
                <p>{{ descriptions.get('services') or 'Book our most common services online with instant scheduling' }}</p>
            </div>
            
            <div class="services-grid">
                {% for service_dict in services %}
                <div class="service-card">
                    <div class="service-image">
                        <img src="{{ service_dict['image'] }}" alt="{{ service_dict['name'] }}">
                        <div class="service-overlay">
                            <button class="btn btn-white service-booking" data-token="70f2d6779a7f41e485069fba41493694" data-orgname="Mayday-Plumbing-LLC">
                                Book Now
                            </button>
                        </div>
                    </div>
                    <div class="service-content">
                        <h3>{{ service_dict['name'] }}</h3>
                        <p>{{ service_dict['description'] }}</p>
                        {% if service_dict['price'] %}
                        <div class="service-price">Starting at ${{ service_dict['price'] }}</div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Dynamic Services Content -->
            {% for panel_dict in meta.get("services", {}).get("panels", []) %}
            <div class="content-panel">
                {{ panel_dict["heading"] | safe }}
                {{ panel_dict["body"] | safe }}
            </div>
            {% endfor %}
        </div>
    </section>


    <!-- FAQ Section -->
    <section id="faq" class="faq-section">
        <div class="container">
            <div class="section-header">
                <h2>Frequently Asked Questions</h2>
                <p>{{ descriptions.get('faq') or 'Find answers to common plumbing questions' }}</p>
            </div>
            
            <div class="search-container">
                <input id="search-field" class="search-input" type="text" placeholder="Search FAQ...">
                <i class="fas fa-search search-icon"></i>
            </div>

            <div class="faq-content" id="faqGrid">
                {% for faq in db_faqs[:5] %}
                <div class="faq-item" data-faq-id="{{ faq.id }}" draggable="{{ 'true' if admin == true else 'false' }}">
                    {% if admin == true %}
                    <div class="drag-handle">
                        <i class="fas fa-grip-vertical"></i>
                    </div>
                    {% endif %}
                    <h3>{{ faq.question }}</h3>
                    <div class="faq-answer">
                        <p>{{ faq.answer }}</p>
                    </div>
                    {% if admin == true %}
                    <div class="admin-actions">
                        <button class="btn-edit-faq" title="Edit FAQ">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-faq" title="Delete FAQ">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                
                {% if admin == true %}
                <div class="faq-item add-faq-item">
                    <h3><i class="fas fa-plus"></i> Add New FAQ</h3>
                    <div class="faq-answer">
                        <p>Click to add a new frequently asked question</p>
                    </div>
                </div>
                {% endif %}
                
                {% if db_faqs|length > 5 %}
                <div class="faq-load-more text-center" style="margin-top: 2rem;">
                    <button id="loadMoreFaqs" class="btn btn-primary">
                        <i class="fas fa-chevron-down"></i>
                        Load More FAQs
                    </button>
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <div class="section-header">
                <h2>Get In Touch</h2>
                <p>{{ descriptions.get('contact') or 'Ready to solve your plumbing problems? Contact us today!' }}</p>
            </div>
            
            <div class="contact-grid">
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <div>
                            <h3>Call Us</h3>
                            <p><a href="tel:5405214181">(540) 521-4181</a></p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <div>
                            <h3>Service Areas</h3>
                            <p>Salem, Roanoke, Daleville, Blacksburg, Floyd, Blue Ridge, Botetourt County, Troutville, VA</p>
                            <div class="service-area-map">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d405204.02969532314!2d-79.98972450000001!3d37.492432!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x43c9de3b04e0b86f%3A0x20e2b6a876ac4221!2sMayday%20Plumbing!5e0!3m2!1sen!2sus!4v1756827871436!5m2!1sen!2sus" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                            </div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h3>Hours</h3>
                            <p>Monday - Friday: 8:00AM - 4:00PM<br>Weekend & After Hours: By Appointment</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-share-alt"></i>
                        <div>
                            <h3>Follow Us</h3>
                            <div class="contact-social-links">
                                <a href="https://www.facebook.com/MaydayPlumbingService/" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                                <a href="https://www.instagram.com/maydayplumbingllc/" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                                <a href="https://www.tiktok.com/@maydayplumbingllc" target="_blank" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
                                <a href="https://share.google/S1n72yKq6FI2ab4DY" target="_blank" aria-label="Google Reviews"><i class="fab fa-google"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="contact-form-container">
                    <form action="/email" class="contact-form" method="POST">
                        <div class="form-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea id="message" name="message" rows="5" placeholder="Describe your plumbing issue..." required></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Send Message
                        </button>
                    </form>
                </div>
            </div>

            <!-- Dynamic Contact Content -->
            {% for panel_dict in meta.get("contact", {}).get("panels", []) %}
            <div class="content-panel">
                {{ panel_dict["heading"] | safe }}
                {{ panel_dict["body"] | safe }}
            </div>
            {% endfor %}
        </div>
    </section>


    <!-- Admin Section -->
    {% if admin == true %}
    <section id="admin" class="admin-section">
        <div class="container">
            <div class="admin-grid">
                <div class="admin-panel">
                    <h3>Section Management</h3>
                    <form action="/admin" class="admin-form" method="POST">
                        <div class="form-group">
                            <label for="section-selector">Section to Update</label>
                            <select id="section-selector" name="section-selector" required>
                                <option value="">Choose a section...</option>
                                <optgroup label="Homepage Content">
                                    <option value="hero-title">Hero Section - Main Title</option>
                                    <option value="hero-subtitle">Hero Section - Subtitle</option>
                                    <option value="all-services-description">Services Section - Description</option>
                                    <option value="services-description">Online Booking Section - Description</option>
                                    <option value="contact-description">Contact Section - Description</option>
                                    <option value="faq-description">FAQ Section - Description</option>
                                </optgroup>
                                <optgroup label="About Page Content">
                                    <option value="about-section1-title">Our Story - Title</option>
                                    <option value="about-section1-text">Our Story - Content</option>
                                    <option value="about-section2-title">Our Team - Title</option>
                                    <option value="about-section2-text">Our Team - Content</option>
                                    <option value="about-section3-title">Our Commitment - Title</option>
                                    <option value="about-section3-text">Our Commitment - Content</option>
                                </optgroup>
                                <optgroup label="Blog Page Content">
                                    <option value="blog-title">Blog Page - Main Title</option>
                                    <option value="blog-subtitle">Blog Page - Subtitle</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group" id="description-group">
                            <label for="description-text">Content Text</label>
                            <textarea id="description-text" name="description-text" rows="4" placeholder="Enter the content for this section..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Update Section</button>
                    </form>
                </div>
                
                <div class="admin-panel">
                    <h3>Announcements</h3>
                    <div class="current-announcement">
                        {% if announcement %}
                        <div class="announcement-display">
                            <strong>Current Announcement:</strong>
                            <p>{{ announcement.text }}</p>
                            <small>Type: {{ announcement.type | capitalize }} | Active: {{ announcement.active }}</small>
                        </div>
                        {% else %}
                        <p class="no-announcement">No active announcement</p>
                        {% endif %}
                    </div>
                    <form action="/admin" class="admin-form" method="POST">
                        <div class="form-group">
                            <label for="announcement-text">Announcement Text</label>
                            <textarea id="announcement-text" name="announcement-text" rows="2" placeholder="Enter announcement text..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="announcement-type">Announcement Type</label>
                            <select id="announcement-type" name="announcement-type">
                                <option value="info">Info (Blue)</option>
                                <option value="success">Success (Green)</option>
                                <option value="warning">Warning (Yellow)</option>
                                <option value="error">Error (Red)</option>
                            </select>
                        </div>
                        <div class="form-group checkbox-group">
                            <label for="announcement-active">
                                <input type="checkbox" id="announcement-active" name="announcement-active" value="true" checked>
                                <span>Active</span>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Update Announcement</button>
                    </form>
                </div>
                
                <div class="admin-panel">
                    <h3>Website Administrator Management</h3>
                    <div class="admin-list">
                        {% for admin in website_administrators %}
                        <div class="admin-item">
                            <div class="admin-info">
                                <span class="admin-name">{{ admin['full_name'] }}</span>
                                <span class="admin-username">@{{ admin['username'] }}</span>
                                <span class="admin-email">{{ admin['email'] }}</span>
                            </div>
                            <button class="btn-delete" data-type="admin" data-id="{{ admin['id'] }}">&times;</button>
                        </div>
                        {% endfor %}
                    </div>
                    <form action="/admin" class="admin-form" method="POST">
                        <div class="form-group">
                            <label for="admin-username">Username</label>
                            <input type="text" id="admin-username" name="admin-username" required pattern="[a-zA-Z0-9_]+" title="Username can only contain letters, numbers, and underscores">
                        </div>
                        <div class="form-group">
                            <label for="admin-email">Email Address</label>
                            <input type="email" id="admin-email" name="admin-email" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-fullname">Full Name</label>
                            <input type="text" id="admin-fullname" name="admin-fullname" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-password">Password</label>
                            <input type="password" id="admin-password" name="admin-password" required minlength="8" title="Password must be at least 8 characters long">
                            <small class="form-help">Minimum 8 characters. This will be used to login to the admin panel.</small>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Website Administrator</button>
                    </form>
                </div>

                <div class="admin-panel">
                    <h3><i class="fas fa-database"></i> Database Management</h3>
                    <div class="database-management">
                        <div class="backup-section">
                            <h4>Database Backup</h4>
                            <p>Create a complete backup of the database for disaster recovery.</p>
                            <button type="button" id="createBackupBtn" class="btn btn-primary">
                                <i class="fas fa-download"></i> Create Backup
                            </button>
                        </div>

                        <div class="backup-section">
                            <h4>Upload Backup</h4>
                            <p>Upload a previously downloaded backup file to restore from.</p>
                            <div class="backup-upload-container">
                                <input type="file" id="backupFileInput" accept=".json,.sql" style="display: none;">
                                <button type="button" id="uploadBackupBtn" class="btn btn-info">
                                    <i class="fas fa-upload"></i> Choose Backup File
                                </button>
                                <div id="uploadStatus" class="upload-status" style="display: none;"></div>
                            </div>
                        </div>

                        <div class="restore-section">
                            <h4>Available Backups</h4>
                            <div id="backupsList" class="backups-list">
                                <p class="loading-text">Loading backups...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-panel">
                    <h3><i class="fas fa-font"></i> Font Management</h3>
                    <div class="font-management">
                        <div class="current-fonts">
                            <h4>Current Font Settings</h4>
                            <div class="font-preview-grid">
                                <div class="font-preview-item">
                                    <label>Headings (H1, H2, H3)</label>
                                    <div class="font-preview-text heading-font-preview">The quick brown fox jumps</div>
                                    <div class="font-info">
                                        <span id="current-heading-font">Space Grotesk</span>
                                    </div>
                                </div>
                                <div class="font-preview-item">
                                    <label>Body Text</label>
                                    <div class="font-preview-text body-font-preview">The quick brown fox jumps over the lazy dog. This is how your body text will appear on the website.</div>
                                    <div class="font-info">
                                        <span id="current-body-font">Manrope</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="font-selector-section">
                            <h4>Update Fonts</h4>
                            <form id="fontManagementForm" class="font-form">
                                <div class="form-group">
                                    <label for="heading-font-select">Heading Font</label>
                                    <select id="heading-font-select" name="heading-font">
                                        <option value="">Select a font...</option>
                                        <optgroup label="Google Fonts (Standard)">
                                            <option value="Space Grotesk">Space Grotesk (Current)</option>
                                            <option value="Inter">Inter</option>
                                            <option value="Roboto">Roboto</option>
                                            <option value="Open Sans">Open Sans</option>
                                            <option value="Lato">Lato</option>
                                            <option value="Montserrat">Montserrat</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Source Sans Pro">Source Sans Pro</option>
                                            <option value="Raleway">Raleway</option>
                                            <option value="Nunito">Nunito</option>
                                            <option value="Playfair Display">Playfair Display</option>
                                            <option value="Merriweather">Merriweather</option>
                                        </optgroup>
                                        <optgroup label="Custom Import">
                                            <option value="custom">Import Custom Font...</option>
                                        </optgroup>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="body-font-select">Body Font</label>
                                    <select id="body-font-select" name="body-font">
                                        <option value="">Select a font...</option>
                                        <optgroup label="Google Fonts (Standard)">
                                            <option value="Manrope">Manrope (Current)</option>
                                            <option value="Inter">Inter</option>
                                            <option value="Roboto">Roboto</option>
                                            <option value="Open Sans">Open Sans</option>
                                            <option value="Lato">Lato</option>
                                            <option value="Montserrat">Montserrat</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Source Sans Pro">Source Sans Pro</option>
                                            <option value="Raleway">Raleway</option>
                                            <option value="Nunito">Nunito</option>
                                            <option value="PT Sans">PT Sans</option>
                                            <option value="Noto Sans">Noto Sans</option>
                                        </optgroup>
                                        <optgroup label="Custom Import">
                                            <option value="custom">Import Custom Font...</option>
                                        </optgroup>
                                    </select>
                                </div>

                                <!-- Custom Heading Font Section -->
                                <div id="custom-heading-font-section" class="custom-font-section" style="display: none;">
                                    <h4>Custom Heading Font Configuration</h4>
                                    <div class="form-group">
                                        <label for="custom-heading-font-name">Custom Heading Font Name</label>
                                        <input type="text" id="custom-heading-font-name" name="custom-heading-font-name" placeholder="e.g., My Custom Heading Font">
                                        <small class="form-help">Enter the exact font family name as it appears in the CSS</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="custom-heading-font-css">CSS Import URL or @font-face Rules for Heading Font</label>
                                        <textarea id="custom-heading-font-css" name="custom-heading-font-css" rows="4" placeholder="Example:
@import url('https://fonts.googleapis.com/css2?family=Your+Font:wght@300;400;700');

OR

@font-face {
  font-family: 'My Custom Font';
  src: url('font.woff2') format('woff2');
}"></textarea>
                                        <small class="form-help">Paste Google Fonts import URL or custom @font-face CSS rules for heading font</small>
                                    </div>
                                </div>

                                <!-- Custom Body Font Section -->
                                <div id="custom-body-font-section" class="custom-font-section" style="display: none;">
                                    <h4>Custom Body Font Configuration</h4>
                                    <div class="form-group">
                                        <label for="custom-body-font-name">Custom Body Font Name</label>
                                        <input type="text" id="custom-body-font-name" name="custom-body-font-name" placeholder="e.g., My Custom Body Font">
                                        <small class="form-help">Enter the exact font family name as it appears in the CSS</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="custom-body-font-css">CSS Import URL or @font-face Rules for Body Font</label>
                                        <textarea id="custom-body-font-css" name="custom-body-font-css" rows="4" placeholder="Example:
@import url('https://fonts.googleapis.com/css2?family=Your+Font:wght@300;400;700');

OR

@font-face {
  font-family: 'My Custom Font';
  src: url('font.woff2') format('woff2');
}"></textarea>
                                        <small class="form-help">Paste Google Fonts import URL or custom @font-face CSS rules for body font</small>
                                    </div>
                                </div>

                                <div class="font-preview-live">
                                    <h4>Live Preview</h4>
                                    <div class="preview-text">
                                        <h2 id="preview-heading">Professional Plumbing Services</h2>
                                        <p id="preview-body">This is how your body text will look with the selected font. We provide reliable plumbing services throughout Virginia.</p>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Apply Font Changes
                                    </button>
                                    <button type="button" id="reset-fonts-btn" class="btn btn-secondary">
                                        <i class="fas fa-undo"></i> Reset to Default
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="admin-panel">
                    <h3><i class="fas fa-question-circle"></i> Admin Help</h3>
                    <p>Need help using the admin interface? Click below to view the complete admin guide.</p>
                    <button type="button" id="adminHelpBtn" class="btn btn-info">
                        <i class="fas fa-book"></i> View Admin Guide
                    </button>
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <div class="image-container" data-image-key="logo">
                            <img src="/static/img/mayday-translucent.png" alt="Mayday Plumbing">
                            {% if admin == true %}
                            <button class="image-upload-btn" title="Replace Logo">
                                <i class="fas fa-camera"></i>
                            </button>
                            <input type="file" class="image-upload-input" accept="image/*" style="display: none;">
                            {% endif %}
                        </div>
                        <h3>Mayday Plumbing LLC</h3>
                    </div>
                    <p>The Help Behind Every Mayday! Licensed, bonded, and insured.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/admin-login">Admin Login</a></li>
                        <li><a href="/#services">Services</a></li>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/#contact">Contact</a></li>
                        <li><a href="/#faq">FAQ</a></li>
                        <li><a href="/blog">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="/#services">Leak Detection & Repair</a></li>
                        <li><a href="/#services">Plumbing Fixture Installation</a></li>
                        <li><a href="/#services">Water Heater Services</a></li>
                        <li><a href="/#services">Whole Home Repipe</a></li>
                        <li><a href="/#services">Sump & Sewage Pump Services</a></li>
                        <li><a href="/#services">Drain Cleaning & Jetting</a></li>
                        <li><a href="/#services">Sewer Line Services</a></li>
                        <li><a href="/#services">Plumbing Inspections</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <div class="contact-info">
                        <p><i class="fas fa-phone"></i> <a class="phone-link" href="tel:5405214181">(540) 521-4181</a></p>
                        <p><i class="fas fa-map-marker-alt"></i> Serving Virginia Areas</p>
                        <p><i class="fas fa-clock"></i> Mon-Fri: 8:00AM-4:00PM</p>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Mayday Plumbing LLC. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Custom Confirmation Modal -->
    <div id="confirmModal" class="confirm-modal">
        <div class="confirm-modal-content">
            <div class="confirm-modal-header">
                <div id="confirmModalIcon" class="confirm-modal-icon">
                    <i class="fas fa-question-circle"></i>
                </div>
                <h3 id="confirmModalTitle" class="confirm-modal-title">Confirm Action</h3>
                <p id="confirmModalMessage" class="confirm-modal-message">Are you sure you want to proceed?</p>
            </div>
            <div class="confirm-modal-actions">
                <button id="confirmModalCancel" class="confirm-btn confirm-btn-cancel">Cancel</button>
                <button id="confirmModalConfirm" class="confirm-btn confirm-btn-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Service Modal -->
    <div id="serviceModal" class="admin-modal" style="display: none;">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h3 id="serviceModalTitle">Add New Service</h3>
                <button class="admin-modal-close" id="serviceModalClose">&times;</button>
            </div>
            <div class="admin-modal-body">
                <form id="serviceForm">
                    <input type="hidden" id="serviceId" name="serviceId">
                    <div class="form-group">
                        <label for="serviceTitle">Service Title</label>
                        <input type="text" id="serviceTitle" name="serviceTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="serviceDescription">Description</label>
                        <textarea id="serviceDescription" name="serviceDescription" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="serviceIcon">Icon</label>
                        <div class="icon-selector">
                            <button type="button" id="selectedIcon" class="selected-icon">
                                <i class="fas fa-search"></i>
                                <span>Click to select icon</span>
                            </button>
                            <div class="icon-grid" id="iconGrid" style="display: none;">
                                {% for icon in available_icons %}
                                <button type="button" class="icon-option" data-icon="{{ icon.class }}">
                                    <i class="{{ icon.class }}"></i>
                                    <span>{{ icon.name }}</span>
                                </button>
                                {% endfor %}
                            </div>
                        </div>
                        <input type="hidden" id="serviceIconValue" name="serviceIcon" value="fas fa-search">
                    </div>
                </form>
            </div>
            <div class="admin-modal-actions">
                <button type="button" id="saveService" class="btn btn-primary">Save Service</button>
                <button type="button" id="cancelService" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div id="faqModal" class="admin-modal" style="display: none;">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h3 id="faqModalTitle">Add New FAQ</h3>
                <button class="admin-modal-close" id="faqModalClose">&times;</button>
            </div>
            <div class="admin-modal-body">
                <form id="faqForm">
                    <input type="hidden" id="faqId" name="faqId">
                    <div class="form-group">
                        <label for="faqQuestion">Question</label>
                        <input type="text" id="faqQuestion" name="faqQuestion" required>
                    </div>
                    <div class="form-group">
                        <label for="faqAnswer">Answer</label>
                        <textarea id="faqAnswer" name="faqAnswer" rows="4" required></textarea>
                    </div>
                </form>
            </div>
            <div class="admin-modal-actions">
                <button type="button" id="saveFaq" class="btn btn-primary">Save FAQ</button>
                <button type="button" id="cancelFaq" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Admin Help Modal -->
    <div id="adminHelpModal" class="admin-modal" style="display: none;">
        <div class="admin-modal-content admin-help-modal" id="adminHelpModalContent">
            <div class="admin-modal-header">
                <h3><i class="fas fa-book"></i> Admin Guide</h3>
                <div class="admin-modal-controls">
                    <button class="admin-modal-fullscreen" id="adminHelpModalFullscreen" title="Toggle Fullscreen">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="admin-modal-close" id="adminHelpModalClose">&times;</button>
                </div>
            </div>
            <div class="admin-modal-body admin-help-content">
                <div class="help-section">
                    <h2>üöÄ Getting Started</h2>
                    <p>Welcome to the Mayday Plumbing admin interface! This guide covers all features available for managing your website.</p>
                    
                    <h3>Admin Panel Access</h3>
                    <ul>
                        <li>Main admin panel is at the bottom of the homepage</li>
                        <li>Look for camera icons üì∑ next to images to replace them</li>
                        <li>Admin controls appear throughout the site when logged in</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h2>üñºÔ∏è Managing Images</h2>
                    <h3>Replacing Images</h3>
                    <ul>
                        <li><strong>Logo:</strong> Click camera icon next to any logo</li>
                        <li><strong>Hero Background:</strong> Click camera icon on hero section</li>
                        <li><strong>About Page Images:</strong> Visit /about and click camera icons</li>
                    </ul>
                    <p><strong>Supported formats:</strong> JPG, PNG, GIF, WebP</p>
                    <p><strong>Recommended sizes:</strong> Logo: 200x200px, Hero: 1920x1080px, About: 800x600px</p>
                </div>

                <div class="help-section">
                    <h2>üìù Content Management</h2>
                    <h3>Section Text Updates</h3>
                    <ol>
                        <li>Go to <strong>Section Management</strong> in admin panel</li>
                        <li>Select section from dropdown</li>
                        <li>Edit content in text area</li>
                        <li>Click <strong>Update Section</strong></li>
                    </ol>
                    <p>Available sections include hero text, about page content, contact info, and more.</p>
                </div>

                <div class="help-section">
                    <h2>üõ†Ô∏è Services Management</h2>
                    <ul>
                        <li><strong>Add:</strong> Click "+ Add New Service" tile</li>
                        <li><strong>Edit:</strong> Click pencil icon on service</li>
                        <li><strong>Delete:</strong> Click trash icon on service</li>
                        <li><strong>Reorder:</strong> Drag and drop services</li>
                    </ul>
                    <p>Fill in title, description, and choose FontAwesome icons (e.g., fas fa-wrench)</p>
                </div>

                <div class="help-section">
                    <h2>‚ùì FAQ Management</h2>
                    <ul>
                        <li><strong>Add:</strong> Click "+ Add New FAQ"</li>
                        <li><strong>Edit:</strong> Click pencil icon on FAQ</li>
                        <li><strong>Delete:</strong> Click trash icon on FAQ</li>
                        <li><strong>Reorder:</strong> Drag and drop FAQs</li>
                    </ul>
                    <p>FAQ answers support HTML formatting for rich content.</p>
                </div>

                <div class="help-section">
                    <h2>üì∞ Blog Management</h2>
                    <p>Visit <strong>/blog</strong> page for blog management:</p>
                    <ul>
                        <li>Use rich text editor for formatting</li>
                        <li>Upload featured images</li>
                        <li>Edit existing posts with pencil icon</li>
                        <li>Delete posts with trash icon</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h2>üë• Website Administrator Management</h2>
                    <p>Manage users who can login to manage the website:</p>
                    <ul>
                        <li>Add website administrators with username, email, full name, and password</li>
                        <li>Remove website administrators from the list</li>
                        <li>New administrators can login using their username and password</li>
                        <li>Passwords are securely hashed and stored</li>
                        <li>Database admin credentials still work for backward compatibility</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h2>üì¢ Announcements</h2>
                    <ul>
                        <li>Create site-wide announcements</li>
                        <li>Choose type: Info (blue), Success (green), Warning (yellow), Error (red)</li>
                        <li>Toggle active status</li>
                        <li>Clear announcements when no longer needed</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h2>üÜò Troubleshooting</h2>
                    <h3>Common Issues:</h3>
                    <ul>
                        <li><strong>Images not uploading:</strong> Check file size (under 5MB) and format</li>
                        <li><strong>Changes not appearing:</strong> Hard refresh (Ctrl+F5)</li>
                        <li><strong>Content not saving:</strong> Check you're still logged in</li>
                        <li><strong>Drag and drop not working:</strong> Use the drag handle (‚â°‚â°)</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h2>üí° Best Practices</h2>
                    <ul>
                        <li>Keep titles under 60 characters for SEO</li>
                        <li>Optimize images before uploading</li>
                        <li>Test on mobile after changes</li>
                        <li>Use action words in service descriptions</li>
                        <li>Update content regularly for better SEO</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script async src="https://online-booking.housecallpro.com/script.js?token=70f2d6779a7f41e485069fba41493694&orgName=Mayday-Plumbing-LLC"></script>

    <!-- Simple admin delete functionality -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Simple admin delete script loaded');

        // Database backup/restore functionality
        const createBackupBtn = document.getElementById('createBackupBtn');
        const uploadBackupBtn = document.getElementById('uploadBackupBtn');
        const backupFileInput = document.getElementById('backupFileInput');
        const uploadStatus = document.getElementById('uploadStatus');
        const backupsList = document.getElementById('backupsList');

        if (createBackupBtn) {
            createBackupBtn.addEventListener('click', async function() {
                createBackupBtn.disabled = true;
                createBackupBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Backup...';

                try {
                    const response = await fetch('/api/database/backup', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        alert(`Backup created successfully: ${result.filename}`);
                        loadBackups(); // Refresh the backups list
                    } else {
                        alert(`Backup failed: ${result.error}`);
                    }
                } catch (error) {
                    console.error('Backup error:', error);
                    alert('Error creating backup');
                } finally {
                    createBackupBtn.disabled = false;
                    createBackupBtn.innerHTML = '<i class="fas fa-download"></i> Create Backup';
                }
            });
        }

        // Load backups list
        async function loadBackups() {
            if (!backupsList) return;

            try {
                const response = await fetch('/api/database/backups');
                const result = await response.json();

                if (result.success && result.backups) {
                    if (result.backups.length > 0) {
                        backupsList.innerHTML = result.backups.map(backup => `
                            <div class="backup-item">
                                <div class="backup-info">
                                    <strong>${backup.filename}</strong>
                                    <small>Created: ${backup.created} | Size: ${formatFileSize(backup.size)} | Type: ${backup.type || 'SQL'}</small>
                                </div>
                                <div class="backup-actions">
                                    <a href="/api/database/backup/${backup.filename}" class="btn btn-sm btn-info download-btn" download>
                                        <i class="fas fa-download"></i> Download
                                    </a>
                                    <button class="btn btn-sm btn-success restore-btn" data-filename="${backup.filename}">
                                        <i class="fas fa-upload"></i> Restore
                                    </button>
                                    <button class="btn btn-sm btn-danger delete-backup-btn" data-filename="${backup.filename}">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>
                        `).join('');

                        // Add event listeners for restore and delete buttons
                        document.querySelectorAll('.restore-btn').forEach(btn => {
                            btn.addEventListener('click', async function() {
                                const filename = this.getAttribute('data-filename');
                                if (confirm(`Are you sure you want to restore from ${filename}? This will OVERWRITE your current database!`)) {
                                    await restoreBackup(filename);
                                }
                            });
                        });

                        document.querySelectorAll('.delete-backup-btn').forEach(btn => {
                            btn.addEventListener('click', async function() {
                                const filename = this.getAttribute('data-filename');
                                if (confirm(`Are you sure you want to delete ${filename}?`)) {
                                    await deleteBackup(filename);
                                }
                            });
                        });
                    } else {
                        backupsList.innerHTML = '<p class="no-backups">No backups available</p>';
                    }
                } else {
                    backupsList.innerHTML = '<p class="error-text">Error loading backups</p>';
                }
            } catch (error) {
                console.error('Error loading backups:', error);
                backupsList.innerHTML = '<p class="error-text">Error loading backups</p>';
            }
        }

        async function restoreBackup(filename) {
            try {
                const response = await fetch('/api/database/restore', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ filename: filename })
                });

                const result = await response.json();

                if (result.success) {
                    alert(`Database restored successfully from ${filename}`);
                    location.reload(); // Reload the page to reflect changes
                } else {
                    alert(`Restore failed: ${result.error}`);
                }
            } catch (error) {
                console.error('Restore error:', error);
                alert('Error restoring backup');
            }
        }

        async function deleteBackup(filename) {
            try {
                const response = await fetch('/api/database/backup', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ filename: filename })
                });

                const result = await response.json();

                if (result.success) {
                    alert(`Backup ${filename} deleted successfully`);
                    loadBackups(); // Refresh the list
                } else {
                    alert(`Delete failed: ${result.error}`);
                }
            } catch (error) {
                console.error('Delete error:', error);
                alert('Error deleting backup');
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Upload backup functionality
        if (uploadBackupBtn && backupFileInput) {
            uploadBackupBtn.addEventListener('click', function() {
                backupFileInput.click();
            });

            backupFileInput.addEventListener('change', async function(event) {
                const file = event.target.files[0];
                if (!file) return;

                // Validate file type
                if (!file.name.endsWith('.json') && !file.name.endsWith('.sql')) {
                    showUploadStatus('error', 'Invalid file type. Only .json and .sql files are allowed.');
                    return;
                }

                // Validate file size (100MB max)
                const maxSize = 100 * 1024 * 1024; // 100MB
                if (file.size > maxSize) {
                    showUploadStatus('error', 'File too large. Maximum size is 100MB.');
                    return;
                }

                showUploadStatus('info', `Uploading ${file.name}...`);
                uploadBackupBtn.disabled = true;

                try {
                    const formData = new FormData();
                    formData.append('backup_file', file);

                    const response = await fetch('/api/database/upload', {
                        method: 'POST',
                        body: formData
                    });

                    const result = await response.json();

                    if (result.success) {
                        showUploadStatus('success', `‚úì ${result.message}`);
                        loadBackups(); // Refresh the backups list

                        // Clear the file input
                        backupFileInput.value = '';

                        // Hide status after 3 seconds
                        setTimeout(() => {
                            uploadStatus.style.display = 'none';
                        }, 3000);
                    } else {
                        showUploadStatus('error', `Upload failed: ${result.error}`);
                    }
                } catch (error) {
                    console.error('Upload error:', error);
                    showUploadStatus('error', 'Upload failed: Network error');
                } finally {
                    uploadBackupBtn.disabled = false;
                }
            });
        }

        function showUploadStatus(type, message) {
            uploadStatus.textContent = message;
            uploadStatus.className = `upload-status upload-status-${type}`;
            uploadStatus.style.display = 'block';
        }

        // Load backups on page load if admin section is visible
        if (backupsList) {
            loadBackups();
        }

        // Handle admin delete buttons
        document.addEventListener('click', async function(e) {
            if (e.target.classList.contains('btn-delete') && e.target.closest('.admin-item')) {
                console.log('Admin delete button clicked');

                const adminId = e.target.getAttribute('data-id');
                if (!adminId) {
                    console.log('No admin ID found');
                    return;
                }

                if (confirm('Are you sure you want to remove this administrator?')) {
                    console.log('User confirmed, sending delete request for admin ID:', adminId);

                    try {
                        const response = await fetch('/admin', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                'website-admin': adminId,
                                action: 'delete'
                            })
                        });

                        console.log('Delete response:', response.status);

                        if (response.ok) {
                            console.log('Delete successful, removing element');
                            e.target.closest('.admin-item').remove();
                        } else {
                            console.error('Delete failed with status:', response.status);
                            alert('Failed to delete administrator');
                        }
                    } catch (error) {
                        console.error('Delete error:', error);
                        alert('Error deleting administrator');
                    }
                }
            }
        });
    });

    {% if recaptcha_site_key %}
    // reCAPTCHA v3 for contact form
    document.querySelector('.contact-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const form = this;

        grecaptcha.ready(function() {
            grecaptcha.execute('{{ recaptcha_site_key }}', {action: 'contact'}).then(function(token) {
                // Add token to form
                const tokenInput = document.createElement('input');
                tokenInput.type = 'hidden';
                tokenInput.name = 'recaptcha_token';
                tokenInput.value = token;
                form.appendChild(tokenInput);

                // Submit form
                form.submit();
            });
        });
    });
    {% endif %}
    </script>

    <script src="/static/js/index.js"></script>
</body>
</html>